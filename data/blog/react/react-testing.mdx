---
title: '[React] React에서 Testing하기'
date: '2023-12-04'
tags: ['react', 'jest', 'test-library']
draft: true
summary: test-library와 jest를 사용하고 TDD를 해보자
---

## TDD란?

## Jest란?

## react-testing-library란?

## File Convention

file.test.js or file.test.tsx
file.spec.js or file.spec.tsx
`__tests__`

## Code Coverage

- statements
- branch
- functions
- lines

```json:package.json
"scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build",
    "test": "react-scripts test",
    "eject": "react-scripts eject",
    "coverage": "yarn test --coverage --watchAll --collectCoverageFrom='src/components/**/*.{ts,tsx}'"
}
```

## Jest Matchers

https://jestjs.io/docs/using-matchers

## Jest-dom

https://github.com/testing-library/jest-dom

## 무엇을 테스트 해야하는가?

component renders
component renders with props
component renders in different states
component reacts to events

## 무엇을 테스트하지 말아야하는가?

Implementation details
Third party code
Code that is not important from a user point of view

## RTL Quries

1. Render the component
2. Find an element render by the component
3. Assert against the element found in step 2 which will pass or fail the test

### getByRole

https://www.w3.org/TR/html-aria/#docconformance

**options**

- name
- level
- hidden
- selected
- checked
- pressed

### getByLabelText

### getByPlaceholderText

### getByText

### getByDisplayValue

### getByAltText

### getByTitle

### getByTestId

## Priority order of Queries

Your test should resemble how users interact with your code(component, page, etc...) as much as possible

1. getByRole
2. getByLabelText
3. getByPlaceholderText
4. getByText
5. getByDisplayValue
6. getByAltText
7. getByTitle
8. getByTestId

## queryBy / queryAllBy

## findBy / findAllBy

## Manual Queries

## debug

## logRoles

## testing playground

## User Interactions

### user-event

```sh
yarn upgrade @testing-library/user-event@latest
```

## Pointer Interactions

click()
dblClick()
tripleClick()
hover()
unhover()

## Keyboard Interactions

type()
clear()
selectOptions()
upload()
tab()

## Clipboard APIs

copy()
cut()
paste()

## Keyboard APIs

######################

## Providers

test-utils.tsx
https://testing-library.com/docs/react-testing-library/setup

## Custom Render Function

renderHook
act

## Mocking functions

jest.fn()

## Mocking http requests

https://mswjs.io/docs/basics/mocking-responses

## Static analysis testing

Process of verifying that your code meets certain expectations without actually running it

- Ensure consistent style and formatting
- Check for common mistakes and possible bugs
- Limit the complexity of code
- Verity type consistency

## Lint

yarn add -D eslint-plugin-jest-dom

```json
  "eslintConfig": {
    "extends": [
      "react-app",
      "react-app/jest",
      "plugin:jest-dom/recommended"
    ]
  }
```

```json:package.json
  "scripts":{
    "lint": "eslint --ignore-path .gitignore .",
  }
```

yarn lint

## Prettier

yarn add --dev --exact prettier

```json:package.json
    "format": "prettier --ignore-path .gitignore --write \"**/*.{ts,tsx,css,scss}\"",
```

```json:.prettierrc.json
{
  "semi": false,
  "singleQuote": true
}
```

yarn format

yarn add -D eslint-config-prettier

## Husky

Husky is a tool that helps improve your commits and more

(npx husky-init) -and (yarn)

```
#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

yarn lint && yarn format
```

## Lint staged
